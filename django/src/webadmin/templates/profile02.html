{% load static %}
<!DOCTYPE html>
<html>

<head>

    {% include 'header.html' %}
    <title>User profile</title>
</head>

<style>

    #open_block button
    {
        margin:5px;
    }
    

    img
    {
        width: 100%;
        height: 100%;
        max-height:600px;
        object-fit: contain;
    }

    .img_profile
    {
        overflow:hidden;
        position:relative;
        display:block;
        width:100%;
        opacity:1.0;
        z-index:0;
        background-color:var(--quaternary-color);
    }

    .profile_block
    {
        display:flex;
        flex-direction:column;
        width:100%:
        height:100%;
    }

    .profile_form
    {
        display:flex;
        flex-direction:column;
        justify-content:center;
        width:100%;
    }

    .profile_page
    {
        display:flex;
        width:80%;
        flex-direction:column;
        gap:20px;
    }

    .logform
    {
        width:100%;
    }

    .login_space
    {
        width:100%;
        height:fit-content;
    }

    .logform
    {
        padding-left:20px; 
        padding-right:10px; 
        padding-top:10px;
    }

    #close_block
    {
        display:none;
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        border-radius: 0;
        justify-content: center;
        align-items: center;
    }

    @media only screen and (min-width:768px) {

    #close_block
    {
        display:none; 
        padding: 5px; 
        width:30%; 
        height:fit-content;
        position:absolute;
        z-index: 10;
        top: 30%;
        left: 30%;
        justify-content: left;
    }

    .profile_form
    {
        display:flex;
        width:70%;
        gap:0;
        align-items: flex-start;
        justify-content: flex-start;
    }

    .profile_block
    {
        display:flex;
        width:30%;
        height:400px;
    }

    .profile_page
    {
        display:flex;
        width:90%;
        flex-direction:row;
        gap:20px;
        margin:5px;
    }

    .overlay
    {
        display:block;
        width:100%;
        height:0;
        position:absolute;
        z-index:10;
        bottom: 0;
        left: 0;
        right: 0;
        background-color:rgba(0,255,255,0.1);
    }

    .img_profile:hover .overlay
    {
        height:100%;
    } 

    .overlay_content
    {
        width:100%;
        height:100%;
        shadow:none;
        border:none;
        background-color:rgba(0,0,0,0);
    }

    }

</style>

<body>

    {% include 'nav.html' %}

    <div class="rows-space" style="align-items: center;"> 

    {% if msg %}

    <div class="device-header" style="font-size:large; padding:5px;">
        {{msg}}
    </div>

    {% endif %}

    <div class="profile_page">

    <div class="profile_block">

    <div class="img_profile block">

    <form method="post" action="/webadmin/img_set/" style="padding:5px;" class="overlay" enctype="multipart/form-data">
        <div class="overlay_content logform" >
            {% csrf_token %}
            {{img_form}}
            <input type="submit" value="Change Picture">
        </div>
    </form>

    <img src="{{profile_img}}" width="800px" height="600px">

    </div>

    </div>

    <div class="profile_form">

       
    <form method="post" action="/webadmin/userup/">

        <div>
            <div style="margin-bottom:10px;">
                {% csrf_token %}
                <div>
                    <p>Login:</p>
                    {{user.username}}
                </div>
                <div>
                    <p>First name:</p>
                    {{user.first_name}}
                </div>
                <div>
                    <p>Second name:</p>
                    {{user.last_name}}
                </div>
                <div>
                    <p>E-mail:</p>
                    {{user.email}}
                </div>
            </div>
                {{profile_form}}
        <input type="submit" value="Update">
        </div>
            
    </form>

    <div id="open_block" class="columns-space">
    <button class="shadow" onclick="show_popup('Generate new card','/webadmin/n_card')">Regenerate card</button>
    <button class="shadow" onclick="show_popup('Logout from basement','/webadmin/l_base')">Leave basement</button>
    <button class="shadow" onclick="show_popup('Program your card','/webadmin/card_prog')">Program card</button>

    {% if user.is_staff %}

    <button class="shadow" onclick="show_popup('Clear program querry','/webadmin/progcls')">Release program querry</button>

    {% endif %}

    </div>

    </div>

    <div class="block shadow" id="close_block">
    
        <div>
            <div class="rows-space" style="width:100%;">
        <button class="cross" onclick="close_popup()">X</button>
        <div class="rows-space" style="align-items: center; margin-bottom:5px; width:100%;">
        <h2>Are you sure?</h2>

        <a href="" id="block_link">
        <button style="background-color:red;" id="block_button"></button>
        </a>
                </div>
            </div>
    </div>

    </div>

    </div>

    </div>

</div>

</body>
<script>

    function show_popup(name,href)
    {
        document.getElementById("close_block").style.display="flex";
        document.getElementById("open_block").style.display="none";
        document.getElementById("block_button").innerHTML=name;
        document.getElementById("block_link").href=href;
    }

    function close_popup()
    {
        document.getElementById("close_block").style.display="none";
        document.getElementById("open_block").style.display="flex";
        document.getElementById("block_button").innerHTML="";
        document.getElementById("block_link").href="";
    }

</script>

</html>